@using Orchard.ContentManagement;
@using Orchard.Security;
@{
    var packageId = Model.ContentItem.PackagePart.PackageId;
    ContentItem contentItem = Model.ContentItem;
    var membership = WorkContext.Resolve<IMembershipService>();
}

<hr />
<div class="media">
    <div class="media-left">
        <a href="@Url.ItemDisplayUrl(contentItem)">
            @if (Model.ContentItem.PackagePart.IconUrl == null) {
                <img class="package-logo media-object" alt="64x64"
                     src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+PCEtLQpTb3VyY2UgVVJMOiBob2xkZXIuanMvNjR4NjQKQ3JlYXRlZCB3aXRoIEhvbGRlci5qcyAyLjYuMC4KTGVhcm4gbW9yZSBhdCBodHRwOi8vaG9sZGVyanMuY29tCihjKSAyMDEyLTIwMTUgSXZhbiBNYWxvcGluc2t5IC0gaHR0cDovL2ltc2t5LmNvCi0tPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PCFbQ0RBVEFbI2hvbGRlcl8xNGY0ZDUxZjAzZiB0ZXh0IHsgZmlsbDojQUFBQUFBO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1mYW1pbHk6QXJpYWwsIEhlbHZldGljYSwgT3BlbiBTYW5zLCBzYW5zLXNlcmlmLCBtb25vc3BhY2U7Zm9udC1zaXplOjEwcHQgfSBdXT48L3N0eWxlPjwvZGVmcz48ZyBpZD0iaG9sZGVyXzE0ZjRkNTFmMDNmIj48cmVjdCB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIGZpbGw9IiNFRUVFRUUiLz48Zz48dGV4dCB4PSIxNC41IiB5PSIzNi41Ij42NHg2NDwvdGV4dD48L2c+PC9nPjwvc3ZnPg=="
                     style="width: 64px; height: 64px;">
            }
            else {
                <img class="package-logo media-object" alt="logo"
                     src="@Model.ContentItem.PackagePart.IconUrl"
                     style="width: 64px; height: 64px;">
            }
        </a>
</div>
    <div class="media-body">
        <h3 class="media-heading">
            @Html.ItemDisplayLink(contentItem) 
            <a href="#" role="button" class="hidden-xs pull-right btn btn-default"><span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> @T("Download")</a>
        </h3>
        <h4>
            @Model.ContentItem.PackagePart.Summary  
        </h4>

        <p class="package-by">
            @{
                dynamic owner = Model.ContentItem.CommonPart.Owner;
            }

            @if(owner != null && !String.IsNullOrEmpty(Model.ContentItem.PackagePart.LatestVersion)) {
                var link = Html.ActionLink((string)Model.ContentItem.PackagePart.LatestVersion, "Display", "PackageVersion", new { id = Model.ContentItem.PackagePart.PackageId, version = Model.ContentItem.PackagePart.LatestVersion }, null);
                @T("{0} published {1} by {2}", link, Display.DateTimeRelative(dateTimeUtc: Model.ContentItem.CommonPart.CreatedUtc), owner.ContentItem.User.DisplayName.Value ?? owner.UserName)
            }
        </p>
        
    </div>
</div>

